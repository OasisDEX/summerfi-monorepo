query GetVaultHistory($vaultId: ID!) {
  vault(id: $vaultId) {
    id
    protocol {
      network
    }
    inputToken {
      symbol
      decimals
    }
    inputTokenBalance
    hourlyVaultHistory: hourlySnapshots(
      first: 721 # 30 days in hours + 1 point of leeway
      orderBy: timestamp
      orderDirection: desc
    ) {
      netValue: inputTokenBalanceNormalized
      navPrice: pricePerShare
      timestamp
    }
    dailyVaultHistory: dailySnapshots(
      first: 366 # 1 year in days + 1 point of leeway
      orderBy: timestamp
      orderDirection: desc
    ) {
      netValue: inputTokenBalanceNormalized
      navPrice: pricePerShare
      timestamp
    }
    weeklyVaultHistory: weeklySnapshots(
      first: 157 # 3 years in weeks + 1 point of leeway
      orderBy: timestamp
      orderDirection: desc
    ) {
      netValue: inputTokenBalanceNormalized
      navPrice: pricePerShare
      timestamp
    }
  }
}

query GetVaultActiveUsers($vaultId: ID!) {
  vault(id: $vaultId) {
    positions {
      account {
        id
      }
      inputTokenDeposits
      inputTokenDepositsNormalized
      latestDeposit: deposits(first:1, orderBy: timestamp, orderDirection: desc) {
        timestamp
      }
      latestWithdrawal: withdrawals(first:1, orderBy: timestamp, orderDirection: desc) {
        timestamp
      }
      firstDeposit: deposits(first:1, orderBy: timestamp, orderDirection: asc) {
        timestamp
      }
      firstWithdrawal: withdrawals(first:1, orderBy: timestamp, orderDirection: asc) {
        timestamp
      }
    }
  }
}

query GetVaultActivityLogByTimestampFrom($vaultId: ID!, $timestampFrom: BigInt!, $timestampTo: BigInt, $targetContractsList: [String!]) {
  vault(id: $vaultId) {
    deposits(
      orderBy: timestamp
      orderDirection: desc
      first: 1000
      where: {timestamp_gt: $timestampFrom, timestamp_lt: $timestampTo}
    ) {
      from
      timestamp
      amount
      hash
    }
    withdraws(
      orderBy: timestamp
      orderDirection: desc
      first: 1000
      where: {timestamp_gt: $timestampFrom, timestamp_lt: $timestampTo}
    ) {
      from
      timestamp
      amount
      hash
    }
    rebalances(
      orderBy: timestamp
      orderDirection: desc
      first: 1000
      where: {timestamp_gt: $timestampFrom, timestamp_lt: $timestampTo}
    ) {
      timestamp
      amount
      hash
      from {
        id
        name
      }
      to {
        id
        name
      }
    }
  }
  curationEvents(
    orderBy: timestamp
    orderDirection: desc
    first: 1000
    where: {timestamp_gt: $timestampFrom, timestamp_lt: $timestampTo, targetContract_in: $targetContractsList}
  ) {
    action
    valueBefore
    valueAfter
    caller
    timestamp
    targetContract
  }
  roleEvents(
    orderBy: timestamp
    orderDirection: desc
    first: 1000
    where: {timestamp_gt: $timestampFrom, timestamp_lt: $timestampTo, role_: {targetContract_in: $targetContractsList}}
  ) {
    action
    caller
    role {
      owner
      name
    }
    timestamp
  }
}