query GetProducts($protocols: [String!], $first: Int = 1000) {
  products(first: $first, where: { protocol_in: $protocols }) {
    id
    protocol
    name
    token {
      id
      symbol
      decimals
      precision
    }
  }
}

# Query latest interest rates
query GetLatestInterestRates(
  $productId: String
  $limit: Int
  $fromTimestamp: BigInt
  $toTimestamp: BigInt
) {
  interestRates(
    orderBy: timestamp
    orderDirection: desc
    first: $limit
    where: { productId: $productId, timestamp_gte: $fromTimestamp, timestamp_lte: $toTimestamp }
  ) {
    id
    type
    rate
    blockNumber
    timestamp
    protocol
    token {
      id
      symbol
      decimals
      precision
    }
    dailyRateId {
      id
      date
      sumRates
      updateCount
      averageRate
      protocol
      token
    }
    hourlyRateId {
      id
      date
      sumRates
      updateCount
      averageRate
      protocol
      token
    }
    weeklyRateId {
      id
      weekTimestamp
      sumRates
      updateCount
      averageRate
      protocol
      token
    }
  }
}

# Query daily rates
query GetDailyRates($productId: String, $fromDate: BigInt, $toDate: BigInt, $limit: Int) {
  dailyInterestRates(
    orderBy: date
    orderDirection: desc
    first: $limit
    where: { productId: $productId, date_gte: $fromDate, date_lte: $toDate }
  ) {
    id
    date
    sumRates
    updateCount
    averageRate
    protocol
    token
    interestRates {
      id
      rate
    }
  }
}

# Query hourly rates
query GetHourlyRates($productId: String, $fromDate: BigInt, $toDate: BigInt, $limit: Int) {
  hourlyInterestRates(
    orderBy: date
    orderDirection: desc
    first: $limit
    where: { productId: $productId, date_gte: $fromDate, date_lte: $toDate }
  ) {
    id
    date
    sumRates
    updateCount
    averageRate
    protocol
    token
    interestRates {
      id
      rate
    }
  }
}

# Query weekly rates
query GetWeeklyRates($productId: String, $fromDate: BigInt, $toDate: BigInt, $limit: Int) {
  weeklyInterestRates(
    orderBy: weekTimestamp
    orderDirection: desc
    first: $limit
    where: { productId: $productId, weekTimestamp_gte: $fromDate, weekTimestamp_lte: $toDate }
  ) {
    id
    weekTimestamp
    sumRates
    updateCount
    averageRate
    protocol
    token
    interestRates {
      id
      rate
    }
  }
}

# Query single token
query GetToken($address: ID!) {
  token(id: $address) {
    id
    symbol
    decimals
    precision
  }
}
